ğŸ“¦ files ğŸ 
ğŸ“¦ sockets ğŸ 

ğŸ ğŸ‡

  ğŸºğŸ†•ğŸ„ 8888â—ï¸ â¡ï¸ SERVER  ğŸ’­ set listening port number
  ğŸ”¤/var/www/emoji/htmlğŸ”¤ â¡ï¸ WEB_ROOT  ğŸ’­ set the web root location

  
  ğŸ‡ğŸğŸ¥¡ â¡ï¸ ğŸ”¡
    ğŸ’­ form html error 404 page
    ğŸ”¤<html>
<head><title>404 Not Found</title></head>
<body>
<center><h1>404 Not Found</h1></center>
<hr><center>Emojicode Engine/0.1a (Linux)</center>
</body>
</html>ğŸ”¤ â¡ï¸ error_page
    
    â†©ï¸ ğŸ”¤HTTP/1.1 404 Not FoundâŒrâŒnContent-Type: text/htmlâŒrâŒnâŒrâŒnğŸ§²error_pageğŸ§²ğŸ”¤
  ğŸ‰ â¡ï¸ error_404_page

  ğŸ‡ğŸğŸ¥¡ â¡ï¸ ğŸ”¡
    ğŸ’­ form html error 400 page
    ğŸ”¤<html>
<head><title>400 Bad Request</title></head>
<body>
<center><h1>400 Bad Request</h1></center>
<hr><center>Emojicode Engine/0.1a (Linux)</center>
</body>
</html>ğŸ”¤ â¡ï¸ error_page
    
    â†©ï¸ ğŸ”¤HTTP/1.1 400 Bad RequestâŒrâŒnContent-Type: text/htmlâŒrâŒnâŒrâŒnğŸ§²error_pageğŸ§²ğŸ”¤
  ğŸ‰ â¡ï¸ error_400_page

    ğŸ‡ğŸğŸ¥¡ â¡ï¸ ğŸ”¡
    ğŸ’­ form html error 403 page
    ğŸ”¤<html>
<head><title>403 Forbidden</title></head>
<body>
<center><h1>403 Forbidden</h1></center>
<hr><center>Emojicode Engine/0.1a (Linux)</center>
</body>
</html>ğŸ”¤ â¡ï¸ error_page
    
    â†©ï¸ ğŸ”¤HTTP/1.1 403 ForbiddenâŒrâŒnContent-Type: text/htmlâŒrâŒnâŒrâŒnğŸ§²error_pageğŸ§²ğŸ”¤
  ğŸ‰ â¡ï¸ error_403_page

  ğŸ‡ğŸğŸ¥¡ arg ğŸ”¡ value ğŸ”¡ â¡ï¸ ğŸ”¡
    ğŸ’­ form html fib page
    ğŸ”¤<html>
<head><title>Fibonacci</title></head>
<body>
<center><h1>Fibonacci sequence</h1></center>
<center><h2>Fib(ğŸ§²argğŸ§²) = ğŸ§²valueğŸ§²</h2></center>
<hr><center>Emojicode Engine/0.1a (Linux)</center>
</body>
</html>ğŸ”¤ â¡ï¸ fib_page
    
    â†©ï¸ ğŸ”¤HTTP/1.1 403 ForbiddenâŒrâŒnContent-Type: text/htmlâŒrâŒnâŒrâŒnğŸ§²fib_pageğŸ§²ğŸ”¤
  ğŸ‰ â¡ï¸ fib_page

  ğŸ’­ğŸ”œ 
      Function to calc fib seq value

      @param arg ğŸ”¡ (Integer Object)
      @return ğŸ”¡ (Integer Object)
  ğŸ”šğŸ’­
  ğŸ‡ğŸğŸ¥¡ arg ğŸ”¢ â¡ï¸ ğŸ”¢
	  â†ªï¸ arg ğŸ™Œ 0 ğŸ‡
  		â†©ï¸ 0
	  ğŸ‰
	  â†ªï¸ arg ğŸ™Œ 1 ğŸ‡
  		â†©ï¸ 1
	  ğŸ‰
	  0 â¡ï¸ ğŸ–ğŸ†• val1
	  1 â¡ï¸ ğŸ–ğŸ†• val2
	  2 â¡ï¸ ğŸ–ğŸ†• index
	  ğŸ” ğŸ‘ ğŸ‡
		  val1 â• val2 â¡ï¸ temp
		  val1 â¬…ï¸â– val1
		  val1 â¬…ï¸â• val2
		  val2 â¬…ï¸â– val2
		  val2 â¬…ï¸â• temp
		  â†ªï¸ arg ğŸ™Œ index ğŸ‡
  			â†©ï¸ val2
		  ğŸ‰
		  index â¬…ï¸â• 1
	  ğŸ‰
	  â†©ï¸ 0
  ğŸ‰ â¡ï¸ fib
  


  ğŸ’­ğŸ”œ 
      Function to craft the response and the body

      @param request_header ğŸ”¡ (String Object)
      @return ğŸ”¡ (String Object)
  ğŸ”šğŸ’­
  ğŸ‡ğŸğŸ¥¡ request_header ğŸ”¡ â¡ï¸ ğŸ”¡

    ğŸ’­ split the request header with the âŒrâŒn (\r\n) delimiter
    ğŸ”« request_header ğŸ”¤âŒrâŒnğŸ”¤ â—ï¸ â¡ï¸ request_header_list

    ğŸ’­ğŸ’­ğŸ’­ testing ğŸ’­ğŸ’­ğŸ’­
    ğŸ”‚ name request_header_list ğŸ‡
       ğŸ’­ğŸ˜€ nameâ—ï¸
    ğŸ‰

    ğŸ’­ only process the status line (first line) for now
    ğŸ½ request_header_list 0â—ï¸ â¡ï¸ status_line

    ğŸ’­ get individual elements form the status line
    ğŸ”« status_line ğŸ”¤ ğŸ”¤ â—ï¸ â¡ï¸ status_line_list

    ğŸ’­ğŸ’­ğŸ’­ testing ğŸ’­ğŸ’­ğŸ’­
    ğŸ”‚ name status_line_list ğŸ‡
       ğŸ’­ğŸ˜€ nameâ—ï¸
    ğŸ‰    

    ğŸ’­ check if the status line has the correct format (3 elements)
    â†ªï¸ ğŸ“ status_line_list â“ â—€ï¸ 3 ğŸ‡
        ğŸ˜€ğŸ”¤[!] Invalid header -> ğŸ§²request_headerğŸ§²ğŸ”¤â—ï¸
        â†©ï¸ ğŸ”¤ğŸ”¤  ğŸ’­ return empty string
    ğŸ‰

    ğŸ’­ store status line element into variables
    
    ğŸ½ status_line_list 0â—ï¸ â¡ï¸ http_method 
    ğŸ½ status_line_list 1â—ï¸ â¡ï¸ ğŸ–ğŸ†•path
    ğŸ½ status_line_list 2â—ï¸ â¡ï¸ http_version

    ğŸ’­ interpret all http requests as GET for simplicity

    ğŸ’­ verify if path starts with a forward slash
    â†ªï¸ğŸ” path ğŸ”¤/ğŸ”¤â—ï¸ ğŸ™Œ ğŸ¤·â€â™€ï¸ ğŸ‡
      ğŸ˜€ğŸ”¤[!] Invalid Status LineğŸ”¤â—ï¸
      â†©ï¸ â‰ï¸ error_400_pageâ—ï¸
    ğŸ‰
    
    ğŸ’­ verify and remove directory traversing symbols from path
    ğŸ’­ split line with the / delimiter
    ğŸ”« path ğŸ”¤/ğŸ”¤ â—ï¸ â¡ï¸ path_list
    ğŸ”‚ path_component path_list ğŸ‡
       ğŸ’­ return status 400 if file traversing is detected
       â†ªï¸ path_component ğŸ™Œ ğŸ”¤..ğŸ”¤ ğŸ‡
         ğŸ˜€ğŸ”¤[400] ğŸ§²http_methodğŸ§² ğŸ§²pathğŸ§² ğŸ§²http_versionğŸ§²ğŸ”¤â—ï¸
         â†©ï¸ â‰ï¸ error_400_pageâ—ï¸
       ğŸ‰
    ğŸ‰

   ğŸ’­ fib http 
    0 â¡ï¸ ğŸ–ğŸ†• idx
    ğŸ”‚ path_component path_list ğŸ‡  
      â†ªï¸ path_component ğŸ™Œ ğŸ”¤fibğŸ”¤ ğŸ‡
        idx â¬…ï¸â• 1
        ğŸ½ path_list idx â—ï¸â¡ï¸ arg
        ğŸ”¢ arg 10â—ï¸â¡ï¸ arg_int
	      â†ªï¸ arg_int â¡ï¸ the_arg_int ğŸ‡
  		    â‰ï¸ fib the_arg_int â—ï¸ â¡ï¸ fib_value
   		    ğŸ”¡ fib_value 10 â—ï¸â¡ï¸ fib_value_string
		      â†©ï¸ â‰ï¸ fib_page arg fib_value_stringâ—ï¸
	      ğŸ‰
      ğŸ‰
      idx â¬…ï¸â• 1
    ğŸ‰
    
    
    ğŸ’­ set default page to index.html
    â†ªï¸ path ğŸ™Œ ğŸ”¤/ğŸ”¤ğŸ‡
      ğŸ”¤/index.htmlğŸ”¤ â¡ï¸ ğŸ–path
    ğŸ‰

    ğŸ’­ A TEMPORARY WORKAROUND TO RETURN A 403 STATUS FOR FOLDERS
    ğŸ’­ AS READING FOLDERS CAUSES A SEGMENTATION FAULT
    ğŸ’­ ***FOLDERS IN LINUX HAS A FILE SIZE OF 4096 BYTES***
    ğŸ’­
    ğŸ’­ check length of file
    ğŸ†— file_size ğŸ“ğŸ•ŠğŸ“‘ ğŸ”¤ğŸ§²WEB_ROOTğŸ§²ğŸ§²pathğŸ§²ğŸ”¤â— ğŸ‡
      ğŸ’­ğŸ˜€ğŸ”¤file size: ğŸ§²file_sizeğŸ§²ğŸ”¤â—ï¸
      â†ªï¸ file_size ğŸ™Œ 4096 ğŸ‡
        ğŸ˜€ğŸ”¤[403] ğŸ§²http_methodğŸ§² ğŸ§²pathğŸ§² ğŸ§²http_versionğŸ§²ğŸ”¤â—ï¸
        â†©ï¸ â‰ï¸ error_403_pageâ—ï¸
      ğŸ‰
    ğŸ‰
    ğŸ™… error_no_file ğŸ‡
      ğŸ˜€ğŸ”¤[400] ğŸ§²http_methodğŸ§² ğŸ§²pathğŸ§² ğŸ§²http_versionğŸ§²ğŸ”¤â—ï¸
      â†©ï¸ â‰ï¸ error_404_pageâ—ï¸
    ğŸ‰

    ğŸ’­ read file from directory
    ğŸ†— file ğŸ“‡ğŸ‡ğŸ“„ğŸ”¤ğŸ§²WEB_ROOTğŸ§²ğŸ§²pathğŸ§²ğŸ”¤â—ï¸ ğŸ‡
      ğŸº ğŸ”¡ file â—ï¸ â¡ï¸ file_contents
      ğŸ“file_contentsâ—ï¸ â¡ï¸ content_length
      ğŸ˜€ğŸ”¤[200] ğŸ§²http_methodğŸ§² ğŸ§²pathğŸ§² ğŸ§²http_versionğŸ§²ğŸ”¤â—ï¸
      â†©ï¸ ğŸ”¤HTTP/1.1 200 OKâŒrâŒnContent-Length: ğŸ§²content_lengthğŸ§²âŒrâŒnâŒrâŒnğŸ§² file_contents ğŸ§²ğŸ”¤ 
    ğŸ‰
    ğŸ™… error_no_file ğŸ‡
      ğŸ˜€ğŸ”¤[400] ğŸ§²http_methodğŸ§² ğŸ§²pathğŸ§² ğŸ§²http_versionğŸ§²ğŸ”¤â—ï¸
      â†©ï¸ â‰ï¸ error_404_pageâ—ï¸
    ğŸ‰

  ğŸ‰ â¡ï¸ craft_response

  
  ğŸ’­ğŸ”œ 
      Main entry of the program
  ğŸ”šğŸ’­
  ğŸ‡ğŸğŸ¥¡
    ğŸ’­ while true
    ğŸ” ğŸ‘ ğŸ‡
      ğŸº ğŸ™‹ SERVERâ—ï¸ â¡ï¸ clientSocket
    
        ğŸ†— data ğŸ‘‚ clientSocket 10000â—ï¸ ğŸ‡
          ğŸ’­ store string interpolation into request_header String variable 
          ğŸ”¤ğŸ§²ğŸº ğŸ”¡dataâ—ï¸ğŸ§²ğŸ”¤ â¡ï¸ request_header
         
           ğŸ’­ declare new string interpolation to store response header
           â‰ï¸ craft_response request_headerâ—ï¸ â¡ï¸ response

           ğŸ’­ Weâ€™ve read 500 bytes and send them back
           ğŸ†—ğŸ’¬ clientSocket ğŸ“‡ response â—ï¸â—ï¸ğŸ‡
             ğŸ’­ do nothing
           ğŸ‰ ğŸ’­ send response + body
           ğŸ™… error_client_socket ğŸ‡
             ğŸ˜€ ğŸ”¤An error occurred: ğŸ§²ğŸ’¬ error_client_socketâ—ï¸ğŸ§²ğŸ”¤â—ï¸
           ğŸ‰
        ğŸ‰ ğŸ’­ client socket
        
        ğŸ™…â€â™€ï¸ error_data ğŸ‡
        ğŸ‰ ğŸ’­ else
        
        ğŸ’­ close the socket
        ğŸ’­ğŸšª clientSocket â—ï¸  ğŸ’­ will cause bad file descriptor
  
    ğŸ‰ ğŸ’­ while true
  ğŸ‰ â¡ï¸ main


  ğŸ’­ğŸ”œ 
      Main execution block
  ğŸ”šğŸ’­
  ğŸ†•ğŸ¨ğŸšğŸ§µğŸ†â—ï¸ â¡ï¸ ğŸ–ğŸ†•threads
  
  ğŸ’­ create n workers to serve the clients
  ğŸ”‚ i ğŸ†•â© 0 512â—ï¸ ğŸ‡
    ğŸ» threads ğŸ†•ğŸ§µ ğŸ‡ ğŸğŸ¥¡
      â‰ï¸ mainâ—ï¸
    ğŸ‰â—ï¸â—ï¸
  ğŸ‰
 
  ğŸ’­ wait for threads to finish before the program ends
  ğŸ’­ much like thread.join()
  ğŸ”‚ thread threads ğŸ‡
    ğŸ›‚ threadâ—ï¸
  ğŸ‰

ğŸ‰ 

